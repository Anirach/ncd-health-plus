(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[194],{98819:function(e,s,a){Promise.resolve().then(a.bind(a,81677))},81677:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return _}});var t=a(57437),l=a(2265),n=a(34768),i=a(78377),c=a(79820),r=a(12381),d=a(94589),m=a(4619),x=a(93448);let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsxs)(m.fC,{ref:s,className:(0,x.cn)("relative flex w-full touch-none select-none items-center",a),...l,children:[(0,t.jsx)(m.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-navy-100 dark:bg-navy-700",children:(0,t.jsx)(m.e6,{className:"absolute h-full bg-teal-500"})}),(0,t.jsx)(m.bU,{className:"block h-5 w-5 rounded-full border-2 border-teal-500 bg-white ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500 disabled:pointer-events-none disabled:opacity-50 cursor-grab active:cursor-grabbing"})]})});o.displayName=m.fC.displayName;var h=a(92371),u=a(95622),b=a(7463),j=a(63810),g=a(69076),f=a(54159),p=a(23850),v=a(11239),N=a(15051),y=a(20265),w=a(21047),k=a(42488);let C={statin:0,htn_med:0,sglt2i:0,metformin:0,smoking:-1,exercise:-1,sbp_reduction:0,weight_loss:0};function _(){let[e,s]=(0,l.useState)([]),[a,m]=(0,l.useState)(null),[x,_]=(0,l.useState)({...C}),[Z,S]=(0,l.useState)(!1);(0,l.useEffect)(()=>{S(!0);let e=(0,h.eq)();s(e);let a=(0,h.wg)();m(e.find(e=>e.id===a)||e[0])},[]);let V=(0,l.useMemo)(()=>{if(!a)return null;let e={};if(x.statin&&!a.statin&&(e.statin=1),x.htn_med&&!a.htn_med&&(e.htn_med=1),x.sglt2i&&!a.sglt2i&&(e.sglt2i=1),x.metformin&&!a.metformin&&(e.metformin=1),x.smoking>=0&&(e.smoking=x.smoking),x.exercise>=0&&(e.exercise=x.exercise),x.sbp_reduction>0&&(e.sbp=a.sbp-x.sbp_reduction),x.weight_loss>0){a.bmi>0&&a.bmi,a.bmi,a.bmi,a.bmi;let s=Math.max(18.5,a.bmi-x.weight_loss/2.5);e.bmi=s}return 0===Object.keys(e).length?{interventionProfile:a,risks:(0,u.gb)(a),deltas:{},activatedEdges:[],baseRisks:(0,u.gb)(a),hasChanges:!1}:{...(0,u.QP)(a,e),baseRisks:(0,u.gb)(a),hasChanges:!0}},[a,x]);if(!Z||!a||!V)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"animate-pulse text-teal-500",children:"Loading..."})});let M=V.baseRisks,E=V.risks,O=[{label:"CVD",base:M.cvd_composite,newVal:E.cvd_composite},{label:"T2DM",base:M.t2dm,newVal:E.t2dm},{label:"CKD",base:M.ckd,newVal:E.ckd},{label:"NCD",base:M.ncd_composite,newVal:E.ncd_composite},{label:"CAD",base:M.cad,newVal:E.cad},{label:"Stroke",base:M.stroke,newVal:E.stroke},{label:"HF",base:M.hf,newVal:E.hf}],D=V.activatedEdges.map(e=>b.$Y.find(s=>s.id===e)).filter(Boolean).slice(0,12);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{}),(0,t.jsxs)("main",{className:"mx-auto max-w-7xl px-4 py-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-navy-800 dark:text-white",children:"What-If Simulator"}),(0,t.jsxs)("p",{className:"text-navy-500 dark:text-navy-300",children:["Explore intervention impacts for ",a.name]})]}),(0,t.jsxs)(r.z,{variant:"outline",onClick:()=>_({...C}),children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 mr-2"})," Reset"]})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-4",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{className:"pb-3",children:(0,t.jsxs)(c.ll,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 text-teal-500"})," Medications"]})}),(0,t.jsxs)(c.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Start Statin"}),(0,t.jsx)(d.r,{checked:1===x.statin,onCheckedChange:e=>_({...x,statin:e?1:0}),disabled:1===a.statin})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Start HTN Med"}),(0,t.jsx)(d.r,{checked:1===x.htn_med,onCheckedChange:e=>_({...x,htn_med:e?1:0}),disabled:1===a.htn_med})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Start SGLT2i"}),(0,t.jsx)(d.r,{checked:1===x.sglt2i,onCheckedChange:e=>_({...x,sglt2i:e?1:0}),disabled:1===a.sglt2i})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"Start Metformin"}),(0,t.jsx)(d.r,{checked:1===x.metformin,onCheckedChange:e=>_({...x,metformin:e?1:0}),disabled:1===a.metformin})]})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{className:"pb-3",children:(0,t.jsxs)(c.ll,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 text-green-500"})," Lifestyle"]})}),(0,t.jsxs)(c.aY,{className:"space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-sm",children:"Quit Smoking"}),(0,t.jsx)(d.r,{checked:0===x.smoking,onCheckedChange:e=>_({...x,smoking:e?0:-1}),disabled:0===a.smoking})]}),a.smoking>0&&(0,t.jsxs)("p",{className:"text-xs text-navy-400",children:["Currently: ",1===a.smoking?"Active smoker":"Former smoker"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm",children:"Exercise"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-teal-600",children:[x.exercise>=0?x.exercise:a.exercise," days/wk"]})]}),(0,t.jsx)(o,{value:[x.exercise>=0?x.exercise:a.exercise],onValueChange:e=>{let[s]=e;return _({...x,exercise:s})},min:0,max:7,step:1}),(0,t.jsxs)("p",{className:"text-xs text-navy-400 mt-1",children:["Currently: ",a.exercise," days/week"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm",children:"Weight Loss"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-teal-600",children:[x.weight_loss," kg"]})]}),(0,t.jsx)(o,{value:[x.weight_loss],onValueChange:e=>{let[s]=e;return _({...x,weight_loss:s})},min:0,max:20,step:1})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm",children:"Reduce SBP by"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-teal-600",children:[x.sbp_reduction," mmHg"]})]}),(0,t.jsx)(o,{value:[x.sbp_reduction],onValueChange:e=>{let[s]=e;return _({...x,sbp_reduction:s})},min:0,max:40,step:5})]})]})]})]}),(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"pb-3",children:[(0,t.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5 text-yellow-500"}),"Live Risk Comparison"]}),(0,t.jsx)(c.SZ,{children:V.hasChanges?"Showing impact of your interventions":"Adjust interventions to see changes"})]}),(0,t.jsx)(c.aY,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsx)(i.Z,{label:"CVD",value:E.cvd_composite,size:"md"}),(0,t.jsx)(i.Z,{label:"T2DM",value:E.t2dm,size:"md"}),(0,t.jsx)(i.Z,{label:"CKD",value:E.ckd,size:"md"}),(0,t.jsx)(i.Z,{label:"Overall NCD",value:E.ncd_composite,size:"md"})]})})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{className:"pb-3",children:(0,t.jsx)(c.ll,{className:"text-base",children:"Before → After"})}),(0,t.jsx)(c.aY,{children:(0,t.jsx)("div",{className:"space-y-2",children:O.map(e=>{let s=e.newVal-e.base,a=100*s,l=s<-.005,n=s>.005;return(0,t.jsxs)(j.E.div,{className:"flex items-center gap-3 p-3 rounded-lg bg-navy-50/50 dark:bg-navy-700/30",layout:!0,children:[(0,t.jsx)("span",{className:"w-16 text-sm font-medium",children:e.label}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative h-6 bg-navy-100 dark:bg-navy-700 rounded-full overflow-hidden",children:[(0,t.jsx)(j.E.div,{className:"absolute top-0 left-0 h-full rounded-full opacity-40",style:{backgroundColor:(0,u.JB)(e.base)},initial:{width:0},animate:{width:"".concat(Math.min(100*e.base,100),"%")},transition:{duration:.5}}),(0,t.jsx)(j.E.div,{className:"absolute top-0 left-0 h-full rounded-full",style:{backgroundColor:(0,u.JB)(e.newVal)},initial:{width:0},animate:{width:"".concat(Math.min(100*e.newVal,100),"%")},transition:{duration:.5}})]})}),(0,t.jsx)("div",{className:"w-20 text-right",children:(0,t.jsxs)("span",{className:"text-sm font-mono",style:{color:(0,u.JB)(e.newVal)},children:[(100*e.newVal).toFixed(1),"%"]})}),(0,t.jsxs)("div",{className:"w-20 text-right",children:[l&&(0,t.jsxs)("span",{className:"text-xs text-green-600 flex items-center justify-end gap-0.5",children:[(0,t.jsx)(N.Z,{className:"h-3 w-3"}),Math.abs(a).toFixed(1),"%"]}),n&&(0,t.jsxs)("span",{className:"text-xs text-red-500 flex items-center justify-end gap-0.5",children:[(0,t.jsx)(y.Z,{className:"h-3 w-3"}),Math.abs(a).toFixed(1),"%"]}),!l&&!n&&(0,t.jsxs)("span",{className:"text-xs text-navy-400 flex items-center justify-end gap-0.5",children:[(0,t.jsx)(w.Z,{className:"h-3 w-3"})," 0.0%"]})]})]},e.label)})})})]}),D.length>0&&(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"pb-3",children:[(0,t.jsxs)(c.ll,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(k.Z,{className:"h-4 w-4 text-teal-500"}),"Activated Causal Pathways"]}),(0,t.jsx)(c.SZ,{children:"Edges in the knowledge graph affected by your interventions"})]}),(0,t.jsx)(c.aY,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:D.map((e,s)=>{if(!e)return null;let a=(0,b.Mk)(e.source),l=(0,b.Mk)(e.target);return(0,t.jsxs)(j.E.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*s},className:"flex items-center gap-2 p-2 rounded-lg bg-navy-50/50 dark:bg-navy-700/30 text-xs",children:[(0,t.jsx)("span",{className:"font-medium text-navy-700 dark:text-navy-200",children:(null==a?void 0:a.label)||e.source}),(0,t.jsx)("span",{className:"text-navy-400",children:"→"}),(0,t.jsx)("span",{className:"font-medium text-navy-700 dark:text-navy-200",children:(null==l?void 0:l.label)||e.target}),(0,t.jsxs)("span",{className:"ml-auto font-mono ".concat(e.weight>0?"text-red-500":"text-green-600"),children:[e.weight>0?"+":"",e.weight.toFixed(2)]})]},e.id)})})})]}),Object.keys(V.deltas).length>0&&(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"pb-3",children:[(0,t.jsx)(c.ll,{className:"text-base",children:"Cascaded Biomarker Changes"}),(0,t.jsx)(c.SZ,{children:"How interventions propagate through the causal graph"})]}),(0,t.jsx)(c.aY,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Object.entries(V.deltas).map(e=>{let[s,a]=e,l=(0,b.Mk)(s);return l&&"disease"!==l.type?(0,t.jsxs)("div",{className:"p-3 rounded-lg bg-navy-50/50 dark:bg-navy-700/30 text-center",children:[(0,t.jsx)("div",{className:"text-xs text-navy-500 dark:text-navy-400",children:l.label}),(0,t.jsxs)("div",{className:"text-sm font-semibold ".concat(a<0?"text-green-600":"text-red-500"),children:[a>0?"+":"","number"==typeof a?a.toFixed(2):a]})]},s):null})})})]})]})]})]})]})}},94589:function(e,s,a){"use strict";a.d(s,{r:function(){return c}});var t=a(57437),l=a(2265),n=a(50721),i=a(93448);let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(n.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-teal-500 data-[state=unchecked]:bg-navy-200 dark:data-[state=unchecked]:bg-navy-600",a),...l,ref:s,children:(0,t.jsx)(n.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});c.displayName=n.fC.displayName}},function(e){e.O(0,[54,810,494,972,934,808,971,117,744],function(){return e(e.s=98819)}),_N_E=e.O()}]);