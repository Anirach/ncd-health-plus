(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92],{86022:function(e,t,s){Promise.resolve().then(s.bind(s,5307))},5307:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var n=s(57437),a=s(2265),r=s(34768),l=s(79820),i=s(92371),o=s(95622),c=s(63810),d=s(3085),h=s(70525),x=s(21047),m=s(33327),p=s(31047),f=s(47625),u=s(5481),g=s(56940),j=s(97059),b=s(62994),y=s(8147),v=s(23263),k=s(21156),N=s(54061);function w(){let[e,t]=(0,a.useState)(null),[s,w]=(0,a.useState)([]),[_,C]=(0,a.useState)(!1);(0,a.useEffect)(()=>{C(!0);let e=(0,i.eq)(),s=(0,i.wg)(),n=e.find(e=>e.id===s)||e[0];if(t(n),n){let e=(0,i.td)(n.id);if(0===e.length&&n){let t=new Date;e=Array.from({length:6},(e,s)=>{let a=new Date(t);return a.setMonth(a.getMonth()-(5-s)),{date:a.toISOString().split("T")[0],profile:{...n,sbp:Math.round(n.sbp*(1+(5-s)*.02)),ldl:Math.round(n.ldl*(1+(5-s)*.03)),hba1c:+(n.hba1c*(1+(5-s)*.015)).toFixed(1),bmi:+(n.bmi*(1+(5-s)*.01)).toFixed(1)}}})}w(e)}},[]);let D=(0,a.useMemo)(()=>s.map(e=>{let t=(0,o.gb)(e.profile);return{date:e.date.slice(5),fullDate:e.date,cvd:+(100*t.cvd_composite).toFixed(1),t2dm:+(100*t.t2dm).toFixed(1),ckd:+(100*t.ckd).toFixed(1),ncd:+(100*t.ncd_composite).toFixed(1),sbp:e.profile.sbp,ldl:e.profile.ldl,hba1c:e.profile.hba1c,bmi:e.profile.bmi}}),[s]),S=(0,a.useMemo)(()=>{if(D.length<2)return null;let e=D[0],t=D[D.length-1];return{cvd:(e.cvd-t.cvd)/e.cvd*100,t2dm:(e.t2dm-t.t2dm)/e.t2dm*100,ckd:(e.ckd-t.ckd)/e.ckd*100,ncd:(e.ncd-t.ncd)/e.ncd*100}},[D]),F=(0,a.useMemo)(()=>{let e=[];for(let t=1;t<D.length;t++){let s=D[t-1],n=D[t];s.ncd>=20&&n.ncd<20&&e.push({date:n.fullDate,text:"NCD risk dropped below 20%!",icon:"\uD83C\uDF89"}),s.cvd>=10&&n.cvd<10&&e.push({date:n.fullDate,text:"CVD risk now in low range!",icon:"\uD83D\uDC9A"}),s.ncd>n.ncd+2&&e.push({date:n.fullDate,text:"NCD risk improved by ".concat((s.ncd-n.ncd).toFixed(1),"%"),icon:"\uD83D\uDCC9"})}return e},[D]);return _&&e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Z,{}),(0,n.jsxs)("main",{className:"mx-auto max-w-7xl px-4 py-6 space-y-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-navy-800 dark:text-white",children:"Progress Tracker"}),(0,n.jsxs)("p",{className:"text-navy-500 dark:text-navy-300",children:["Tracking ",e.name,"'s journey over time"]})]})}),S&&(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"CVD",val:S.cvd},{label:"T2DM",val:S.t2dm},{label:"CKD",val:S.ckd},{label:"Overall NCD",val:S.ncd}].map(e=>(0,n.jsx)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:(0,n.jsx)(l.Zb,{children:(0,n.jsxs)(l.aY,{className:"pt-6 text-center",children:[(0,n.jsx)("div",{className:"text-2xl font-bold ".concat(e.val>0?"text-green-600":e.val<0?"text-red-500":"text-navy-500"),children:e.val>0?(0,n.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,n.jsx)(d.Z,{className:"h-5 w-5"})," ",e.val.toFixed(1),"%"]}):e.val<0?(0,n.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,n.jsx)(h.Z,{className:"h-5 w-5"})," ",Math.abs(e.val).toFixed(1),"%"]}):(0,n.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,n.jsx)(x.Z,{className:"h-5 w-5"})," 0%"]})}),(0,n.jsxs)("div",{className:"text-sm text-navy-500 dark:text-navy-400 mt-1",children:[e.label," Improvement"]})]})})},e.label))}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)(l.Ol,{children:[(0,n.jsx)(l.ll,{children:"Risk Trends Over Time"}),(0,n.jsx)(l.SZ,{children:"Composite risk scores across visits"})]}),(0,n.jsx)(l.aY,{children:(0,n.jsx)(f.h,{width:"100%",height:300,children:(0,n.jsxs)(u.T,{data:D,children:[(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"ncdGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.3}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:0})]}),(0,n.jsxs)("linearGradient",{id:"cvdG",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#EF4444",stopOpacity:.2}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#EF4444",stopOpacity:0})]}),(0,n.jsxs)("linearGradient",{id:"t2dmG",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.2}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),(0,n.jsxs)("linearGradient",{id:"ckdG",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#22C55E",stopOpacity:.2}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#22C55E",stopOpacity:0})]})]}),(0,n.jsx)(g.q,{strokeDasharray:"3 3",stroke:"#E2E8F0"}),(0,n.jsx)(j.K,{dataKey:"date",fontSize:12,stroke:"#94A3B8"}),(0,n.jsx)(b.B,{fontSize:12,stroke:"#94A3B8",unit:"%"}),(0,n.jsx)(y.u,{contentStyle:{backgroundColor:"#1B2A4A",border:"none",borderRadius:"8px",color:"white",fontSize:"12px"}}),(0,n.jsx)(v.u,{type:"monotone",dataKey:"ncd",stroke:"#8B5CF6",fill:"url(#ncdGrad)",strokeWidth:3,name:"Overall NCD"}),(0,n.jsx)(v.u,{type:"monotone",dataKey:"cvd",stroke:"#EF4444",fill:"url(#cvdG)",strokeWidth:2,name:"CVD"}),(0,n.jsx)(v.u,{type:"monotone",dataKey:"t2dm",stroke:"#3B82F6",fill:"url(#t2dmG)",strokeWidth:2,name:"T2DM"}),(0,n.jsx)(v.u,{type:"monotone",dataKey:"ckd",stroke:"#22C55E",fill:"url(#ckdG)",strokeWidth:2,name:"CKD"})]})})})]}),(0,n.jsx)("div",{className:"grid md:grid-cols-2 gap-6",children:[{label:"Blood Pressure (SBP)",key:"sbp",color:"#EF4444",unit:"mmHg"},{label:"LDL Cholesterol",key:"ldl",color:"#F59E0B",unit:"mg/dL"},{label:"HbA1c",key:"hba1c",color:"#3B82F6",unit:"%"},{label:"BMI",key:"bmi",color:"#8B5CF6",unit:"kg/m\xb2"}].map(e=>(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{className:"pb-2",children:(0,n.jsx)(l.ll,{className:"text-sm",children:e.label})}),(0,n.jsx)(l.aY,{children:(0,n.jsx)(f.h,{width:"100%",height:150,children:(0,n.jsxs)(k.w,{data:D,children:[(0,n.jsx)(g.q,{strokeDasharray:"3 3",stroke:"#E2E8F0"}),(0,n.jsx)(j.K,{dataKey:"date",fontSize:10,stroke:"#94A3B8"}),(0,n.jsx)(b.B,{fontSize:10,stroke:"#94A3B8"}),(0,n.jsx)(y.u,{contentStyle:{backgroundColor:"#1B2A4A",border:"none",borderRadius:"8px",color:"white",fontSize:"11px"}}),(0,n.jsx)(N.x,{type:"monotone",dataKey:e.key,stroke:e.color,strokeWidth:2,dot:{r:3},name:e.label})]})})})]},e.key))}),F.length>0&&(0,n.jsxs)(l.Zb,{children:[(0,n.jsx)(l.Ol,{children:(0,n.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(m.Z,{className:"h-5 w-5 text-yellow-500"})," Milestones"]})}),(0,n.jsx)(l.aY,{children:(0,n.jsx)("div",{className:"space-y-3",children:F.map((e,t)=>(0,n.jsxs)(c.E.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-center gap-3 p-3 rounded-lg bg-gradient-to-r from-yellow-50 to-transparent dark:from-yellow-900/20 dark:to-transparent",children:[(0,n.jsx)("span",{className:"text-2xl",children:e.icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:e.text}),(0,n.jsxs)("div",{className:"text-xs text-navy-400 flex items-center gap-1",children:[(0,n.jsx)(p.Z,{className:"h-3 w-3"}),e.date]})]})]},t))})})]}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)(l.Ol,{children:[(0,n.jsx)(l.ll,{children:"Visit Timeline"}),(0,n.jsx)(l.SZ,{children:"Lab results history across visits"})]}),(0,n.jsx)(l.aY,{children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b border-navy-100 dark:border-navy-700",children:[(0,n.jsx)("th",{className:"text-left py-2 px-3 text-navy-500",children:"Date"}),(0,n.jsx)("th",{className:"text-right py-2 px-3 text-navy-500",children:"SBP"}),(0,n.jsx)("th",{className:"text-right py-2 px-3 text-navy-500",children:"LDL"}),(0,n.jsx)("th",{className:"text-right py-2 px-3 text-navy-500",children:"HbA1c"}),(0,n.jsx)("th",{className:"text-right py-2 px-3 text-navy-500",children:"BMI"}),(0,n.jsx)("th",{className:"text-right py-2 px-3 text-navy-500",children:"NCD Risk"})]})}),(0,n.jsx)("tbody",{children:s.map((e,t)=>{let s=(0,o.gb)(e.profile);return(0,n.jsxs)("tr",{className:"border-b border-navy-50 dark:border-navy-800",children:[(0,n.jsx)("td",{className:"py-2 px-3 font-medium",children:e.date}),(0,n.jsx)("td",{className:"py-2 px-3 text-right",children:e.profile.sbp}),(0,n.jsx)("td",{className:"py-2 px-3 text-right",children:e.profile.ldl}),(0,n.jsx)("td",{className:"py-2 px-3 text-right",children:e.profile.hba1c}),(0,n.jsx)("td",{className:"py-2 px-3 text-right",children:e.profile.bmi}),(0,n.jsx)("td",{className:"py-2 px-3 text-right",children:(0,n.jsxs)("span",{className:"font-medium",style:{color:(0,o.JB)(s.ncd_composite)},children:[(100*s.ncd_composite).toFixed(1),"%"]})})]},t)})})]})})})]})]})]}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)("div",{className:"animate-pulse text-teal-500",children:"Loading..."})})}},95622:function(e,t,s){"use strict";s.d(t,{Dh:function(){return u},JB:function(){return f},Pf:function(){return m},QP:function(){return p},gb:function(){return x},wE:function(){return g}});var n=s(7463);let a={age:{mean:55,std:12},sex:{mean:.5,std:.5},sbp:{mean:130,std:18},dbp:{mean:82,std:10},ldl:{mean:130,std:35},hdl:{mean:50,std:14},tc:{mean:210,std:40},tg:{mean:150,std:70},hba1c:{mean:5.8,std:.9},fpg:{mean:105,std:25},bmi:{mean:26,std:4.5},egfr:{mean:85,std:22},smoking:{mean:.25,std:.4},exercise:{mean:2.5,std:2},alcohol:{mean:.2,std:.3},diet:{mean:.5,std:.25},statin:{mean:.2,std:.4},htn_med:{mean:.3,std:.45},sglt2i:{mean:.05,std:.22},metformin:{mean:.15,std:.35},aspirin:{mean:.15,std:.35},ace_arb:{mean:.2,std:.4},diabetes:{mean:.15,std:.35},hypertension:{mean:.35,std:.48}},r={cad:-2.5,stroke:-3,hf:-3.2,pad:-3.5,t2dm:-2.8,ckd:-2.6,nafld:-2};function l(e){return 1/(1+Math.exp(-e))}function i(e,t){let s=a[e];return s?(t-s.mean)/s.std:0}function o(e){let t={...e};return t.diabetes=t.hba1c>=6.5||t.fpg>=126?1:t.hba1c>=5.7||t.fpg>=100?.5:0,t.hypertension=t.sbp>=140||t.dbp>=90?1:t.sbp>=130||t.dbp>=85?.5:0,t}function c(e,t){var s;return null!==(s=e[t])&&void 0!==s?s:0}function d(e,t){var s;let a=o(e),d=null!==(s=r[t])&&void 0!==s?s:-2.5,h=(0,n.FB)(t),x=d;for(let e of h){let t=c(a,e.source),s=i(e.source,t);x+=e.weight*s}return l(x)}function h(e,t){var s;let a=o(e),d=null!==(s=r[t])&&void 0!==s?s:-2.5,h=(0,n.FB)(t),x=d,m=d,p=d;for(let e of h){let t=c(a,e.source),s=i(e.source,t);x+=e.weight*s,s>=0?(m+=e.ci[0]*s,p+=e.ci[1]*s):(m+=e.ci[1]*s,p+=e.ci[0]*s)}return{value:l(x),ci_low:l(m),ci_high:l(p)}}function x(e){let t=d(e,"cad"),s=d(e,"stroke"),n=d(e,"hf"),a=d(e,"pad"),r=d(e,"t2dm"),l=d(e,"ckd"),i=d(e,"nafld"),o=1-(1-t)*(1-s)*(1-n)*(1-a);return{cad:t,stroke:s,hf:n,pad:a,t2dm:r,ckd:l,nafld:i,cvd_composite:o,ncd_composite:1-(1-o)*(1-r)*(1-l)}}function m(e){let t=h(e,"cad"),s=h(e,"stroke"),n=h(e,"hf"),a=h(e,"pad"),r=h(e,"t2dm"),l=h(e,"ckd"),i=h(e,"nafld"),o=1-(1-t.value)*(1-s.value)*(1-n.value)*(1-a.value),c=1-(1-t.ci_low)*(1-s.ci_low)*(1-n.ci_low)*(1-a.ci_low),d=1-(1-t.ci_high)*(1-s.ci_high)*(1-n.ci_high)*(1-a.ci_high),x=1-(1-o)*(1-r.value)*(1-l.value),m=1-(1-c)*(1-r.ci_low)*(1-l.ci_low),p=1-(1-d)*(1-r.ci_high)*(1-l.ci_high);return{cad:t,stroke:s,hf:n,pad:a,t2dm:r,ckd:l,nafld:i,cvd_composite:{value:o,ci_low:c,ci_high:d},ncd_composite:{value:x,ci_low:m,ci_high:p}}}function p(e,t){let s=o(e),a={},r={},l=[];for(let e of n._j)a[e]=c(s,e);for(let[e,s]of Object.entries(t))if(void 0!==s){let t=s-(a[e]||0);a[e]=s,r[e]=t}for(let e of n._j){if(t.hasOwnProperty(e))continue;let o=n.$Y.filter(t=>t.target===e),d=0;for(let e of o){var i;let r=(null!==(i=a[e.source])&&void 0!==i?i:0)-c(s,e.source);if(Math.abs(r)>.001){let s=4;for(let a of Object.keys(t))s=Math.min(s,function(e,t){let s=new Set,a=[{node:e,depth:0}];for(;a.length>0;){let{node:e,depth:r}=a.shift();if(e===t)return r;if(!(r>=3))for(let t of(s.add(e),n.$Y.filter(t=>t.source===e)))s.has(t.target)||a.push({node:t.target,depth:r+1})}return 4}(a,e.source)+1);if(s<=3){let t=Math.pow(.7,s),n=e.weight*r*t;d+=n,Math.abs(n)>.001&&l.push(e.id)}}}Math.abs(d)>.001&&(a[e]=c(s,e)+d,r[e]=d)}let d={...e,...t};for(let[e,n]of Object.entries(r))t.hasOwnProperty(e)||(d[e]=c(s,e)+n);for(let[e]of Object.entries(t))for(let t of n.$Y.filter(t=>t.source===e))l.push(t.id);let h=x(d);return{interventionProfile:d,risks:h,deltas:r,activatedEdges:Array.from(new Set(l))}}function f(e){return e<.1?"#22C55E":e<.2?"#EAB308":e<.3?"#F97316":"#EF4444"}function u(e){return e<.1?"Low":e<.2?"Moderate":e<.3?"High":"Very High"}let g=[{id:"demo-low",name:"Sarah Chen",age:40,sex:0,sbp:115,dbp:72,ldl:95,hdl:62,tc:185,tg:90,hba1c:5.2,fpg:88,bmi:22.5,egfr:105,smoking:0,exercise:5,alcohol:0,diet:.8,statin:0,htn_med:0,sglt2i:0,metformin:0,aspirin:0,ace_arb:0},{id:"demo-moderate",name:"James Wilson",age:55,sex:1,sbp:148,dbp:92,ldl:162,hdl:38,tc:245,tg:210,hba1c:6.1,fpg:112,bmi:29.5,egfr:78,smoking:0,exercise:1,alcohol:.5,diet:.4,statin:0,htn_med:0,sglt2i:0,metformin:0,aspirin:0,ace_arb:0},{id:"demo-high",name:"Robert Martinez",age:65,sex:1,sbp:168,dbp:98,ldl:185,hdl:32,tc:280,tg:290,hba1c:8.2,fpg:165,bmi:33.5,egfr:52,smoking:1,exercise:0,alcohol:.5,diet:.2,statin:0,htn_med:0,sglt2i:0,metformin:0,aspirin:0,ace_arb:0}]},92371:function(e,t,s){"use strict";s.d(t,{Yg:function(){return d},bY:function(){return x},bo:function(){return o},eq:function(){return i},td:function(){return h},wg:function(){return c}});var n=s(95622);let a="ncd-health-plus-patients",r="ncd-health-plus-active",l="ncd-health-plus-history";function i(){try{let e=localStorage.getItem(a);if(e)return JSON.parse(e)}catch(e){}return n.wE}function o(e){localStorage.setItem(a,JSON.stringify(e))}function c(){return localStorage.getItem(r)||"demo-moderate"}function d(e){localStorage.setItem(r,e)}function h(e){try{let t=localStorage.getItem("".concat(l,"-").concat(e));if(t)return JSON.parse(t)}catch(e){}return[]}function x(e,t){let s=h(e);s.push({date:new Date().toISOString().split("T")[0],profile:t}),localStorage.setItem("".concat(l,"-").concat(e),JSON.stringify(s))}}},function(e){e.O(0,[54,810,717,512,934,971,117,744],function(){return e(e.s=86022)}),_N_E=e.O()}]);